<!DOCTYPE html>
<!-- <html lang="en,zh-CN,default"> -->
<html lang="en">


<head>
  <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Levy Liu">







<title>SUMMARY | Levy&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">



<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto+Mono&display=swap');
</style>



    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/css/color_mode/classic.css">
    
    <link rel="stylesheet" href="/css/color_mode/dark.css">
    
    <link rel="stylesheet" href="/lib/viewer/viewer.min.css">
    




    <!-- scripts list from _config.yml -->
    
    <script src="/js/menu.js"></script>
    
    <script src="/js/format.js"></script>
    
    <script src="/js/search.js"></script>
    
    <script src="/lib/viewer/viewer.min.js"></script>
    










<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <!-- <div class="image-preview-mask">
    <div class="image-preview-container">
      <div id="img-preview"></div>
    </div>
  </div> -->
  <div class="mask-border">
  </div>

  <div class="wrapper">

    <div class="header">
  <div class="flex-container">
    <div class="header-inner">
      <div class="site-brand-container">
        <a href="/">
          
            Levy&#39;s Blog.🦊
          
        </a>
      </div>
      <div id="menu-btn" class="menu-btn" onclick="toggleMenu()">
        Menu
      </div>
      <nav class="site-nav">
        
        <ul class="menu-list">
          
            <!-- 
              url_for是一个函数，它可以把一个路径转换为完整的URL
              url_for(page.path) 当前页面的URL
            -->
            <!-- 高亮显示 -->
            
              <li class="menu-item">
                <a href="/">Home</a>
              </li> 
                   
          
            <!-- 
              url_for是一个函数，它可以把一个路径转换为完整的URL
              url_for(page.path) 当前页面的URL
            -->
            <!-- 高亮显示 -->
            
              <li class="menu-item">
                <a href="/archives/">Archive</a>
              </li> 
                   
          
            <!-- 
              url_for是一个函数，它可以把一个路径转换为完整的URL
              url_for(page.path) 当前页面的URL
            -->
            <!-- 高亮显示 -->
            
              <li class="menu-item">
                <a href="/categories/gallery/">Gallery</a>
              </li> 
                   
          
          <!-- 搜索功能 -->
          
            <li class="menu-item search-btn">
              <a href="#">Search</a>
            </li>
          
          

          <!-- Some tags or posts doesn't have alternative language version, so we don't render language switcher for them -->
          
        </ul>
      </nav>
    </div>
  </div>
</div>


<script>
  /* const button = document.querySelector('button')
  button.addEventListener('clcik', ()=>{
    document.body.classList.add('')
  }) */
</script>

      <div class="main">
        <div class="flex-container">
          <article id="post">
  
    <div class="post-head">
    
    <div class="post-info">
        <div class="tag-list">
            

                
                    <span class="post-tag">
                        <a href="/tags/%C2%A1importante/">
                            ¡importante!
                        </a>
                    </span>
                    
                        
        </div>
        <div class="post-title">

            
                SUMMARY
                    
        </div>
        <span class="post-date">
            Mar 25, 2024
        </span>
        <span class="post-word-count">
            3247 words / About 18 minutes

            <span class="post-word-count-tooltip">Only English content is counted</sapn>
        </span>

        
    </div>
    <div class="post-img">
        
                <div class="h-line-primary"></div>
                
    </div>
</div>
    <div class="post-content">
    <!-- <-page.content -->
    <div class="toc"></div>
<div class="post-body">
    <h2 id="01-数据类型"><a class="markdownIt-Anchor" href="#01-数据类型"></a> 01 数据类型</h2>
<p>基本数据类型：</p>
<ul>
<li>Null
<ul>
<li><code>typeof null 等于 object</code></li>
</ul>
</li>
<li>Undefined
<ul>
<li>Let var 声明未初始化值为 undefined</li>
</ul>
</li>
<li>Boolean
<ul>
<li>falsely=== <code>null undefined 0 '' NaN </code></li>
</ul>
</li>
<li>Number
<ul>
<li>10 进制 <code>1</code></li>
<li>8 进制 0 开头 <code>070</code></li>
<li>16 进制 0x 开头 <code>0x1</code></li>
<li>浮点数 包含小数点 <code>1.1</code> <code>1.0</code> <code>.1</code> <code>3.14e10</code> 科学计数法</li>
<li>NaN 不是数值 <code>Object.is(NaN,NaN) 返回true</code></li>
</ul>
</li>
<li>String</li>
<li>Symbol</li>
</ul>
<p>（栈）值类型：String 、Number、 Boolean、 Symbol</p>
<p>（堆）引用类型：object{}、 Array、 <strong>null</strong>、function</p>
<h2 id="02-数组方法"><a class="markdownIt-Anchor" href="#02-数组方法"></a> 02 数组方法</h2>
<p>splice <code>增(return [])</code> <code> 删return删除数组</code> <code>改return[]</code> 不影响原数组</p>
<p>splice(initIndex, deleteNum, InsertElement) 返回数组</p>
<p>slice (from, to) 截取数组，不会影响原数组，返回新数组</p>
<ul>
<li>
<p>增</p>
<ul>
<li>push() 尾部增加 返货数组新长度</li>
<li>unshift 首部增加 返回数组新长度</li>
<li>concat(“yellow”, [“red”, “green”]) 不会改变原数组</li>
</ul>
</li>
<li>
<p>删</p>
<ul>
<li>
<p>pop() 返回删除元素</p>
</li>
<li>
<p>shift 返回删除元素</p>
</li>
</ul>
</li>
<li>
<p>查</p>
<ul>
<li>indexOf() 返回元素所在索引，没有返回-1</li>
<li>includes() 返回 true/false</li>
<li>find 返回第一个查找元素, 没有返回 undefined (finnIndex、findLast、findLastIndex）</li>
</ul>
</li>
</ul>
<h3 id="排序方法"><a class="markdownIt-Anchor" href="#排序方法"></a> 排序方法：</h3>
<ul>
<li>sort(?compareFn) —toSorted</li>
<li>reverse --toReverse</li>
</ul>
<h3 id="转换"><a class="markdownIt-Anchor" href="#转换"></a> 转换</h3>
<ul>
<li>join(?separator) 转为由分隔符分隔的字符串
<ul>
<li>
<img src="/Users/liuye/学习/前端/ForInternNotes/note/2数组方法.assets/image-20230918150627981.png" alt="image-20230918150627981" style="width:30%; float:left;" />
</li>
</ul>
</li>
</ul>
<h3 id="迭代"><a class="markdownIt-Anchor" href="#迭代"></a> 迭代</h3>
<p>（都有 thisArg 形参，更改回调函数体内 this 指向，但是<strong>直接使用</strong>箭头函数 this 仍指向上一层 this）</p>
<ul>
<li>some() 某一个符合条件 true，every 全部符合条件 true</li>
<li>forEach、filter、map</li>
</ul>
<h2 id="03-字符串方法"><a class="markdownIt-Anchor" href="#03-字符串方法"></a> 03 字符串方法</h2>
<ul>
<li>增 (返回副本)
<ul>
<li><code>+</code> <code>$&#123;&#125;</code></li>
<li>concat()</li>
</ul>
</li>
<li>删（返回副本）
<ul>
<li>slice(startIndex, endIndex)(与 substring 差不多，但 substring 不支持负数索引，start &gt; end 交换索引)</li>
<li>substr(startIndex, length)</li>
</ul>
</li>
<li>改
<ul>
<li>trim、trimLeft/Right 删空格</li>
<li>repeat(count) 重复几次这个字符串</li>
<li>padStart/End(maxLength, ?fillString) 不符合 maxLength 就长度填充， 默认填充空格</li>
</ul>
</li>
<li>查
<ul>
<li>charAt(index) 根据索引返回元素，没有返回空串</li>
<li>indexOf</li>
<li>startWith include 查找返回 true/false</li>
</ul>
</li>
</ul>
<p>转换方法</p>
<ul>
<li>split() 字符串转数组
<ul>
<li>
<img src="/Users/liuye/学习/前端/ForInternNotes/note/2数组方法.assets/image-20230918155323753.png" alt="image-20230918155323753" style="width:30%; float:left" />
</li>
</ul>
</li>
</ul>
<p>模板匹配</p>
<ul>
<li>match(<code>whichpattern</code>)</li>
<li>search</li>
<li>replace(originString, replaceString) (reg, function(match, …))</li>
</ul>
<h2 id="04-ajax"><a class="markdownIt-Anchor" href="#04-ajax"></a> 04 AJAX</h2>
<p>Ajax 允许我们利用 js 和 xmlHttpRequest 在后台与服务器交换数据</p>
<p>允许我们不用刷新网页，与后端交换数据，局部更新部分网页</p>
<p><mark>通过 XmlHttpRequest 向服务器发送异步请求，从服务器获得数据，利用 js 操作 dom 更新页面</mark></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 创建xhr对象实例</span></span><br><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line"><span class="comment">//与服务器创建连接</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="literal">true</span>)</span><br><span class="line"><span class="comment">//给服务端发送数据</span></span><br><span class="line">xhr.<span class="title function_">send</span>()</span><br><span class="line"><span class="comment">//接受服务端数据相应</span></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="comment">//done 整个过程请求完成</span></span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">status</span> &gt;= <span class="number">200</span> &amp;&amp; shr.<span class="property">status</span> &lt;= <span class="number">300</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="05-数据传输"><a class="markdownIt-Anchor" href="#05-数据传输"></a> 05 数据传输</h2>
<p>multipart/form-data 可以<strong>传输二进制文件</strong></p>
<p>application/x-www-form-urlencoded 用于传输普通的表单数据,</p>
<p>application/json 用于传输 JSON 对象,</p>
<p>二者都不会传输文件,主要传输<strong>字符串</strong>、<strong>数字类型</strong>的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">upload</span>(<span class="params">url, Form</span>) &#123;</span><br><span class="line">  <span class="comment">// FormData格式提交给后端</span></span><br><span class="line">  <span class="keyword">const</span> params = <span class="keyword">new</span> <span class="title class_">FormData</span>()</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> <span class="title class_">Form</span>) &#123;</span><br><span class="line">    params.<span class="title function_">append</span>(i, <span class="title class_">Form</span>[i])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//这里使用了 params.append(name, value) 方法,将字段名和值添加到 FormData 对象中。</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> axios</span><br><span class="line">    .<span class="title function_">post</span>(url, params, &#123;</span><br><span class="line">      <span class="attr">headers</span>: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="property">data</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="06-url-to-browser"><a class="markdownIt-Anchor" href="#06-url-to-browser"></a> 06 URL To Browser</h2>
<p>url</p>
<p>协议 + 域名 + 资源名(目录名/文件名)</p>
<h3 id="dns-解析"><a class="markdownIt-Anchor" href="#dns-解析"></a> DNS 解析</h3>
<p>找缓存-</p>
<ol>
<li>浏览器</li>
<li>操作系统</li>
<li>本地 host</li>
</ol>
<p>没有缓存</p>
<p>向域名服务器发送请求(dig +trace <a target="_blank" rel="noopener" href="http://baidu.com">baidu.com</a>)</p>
<ol>
<li>根域名 .</li>
<li>顶级域名 .com</li>
<li>权威域名 <a target="_blank" rel="noopener" href="http://baidu.com">baidu.com</a></li>
</ol>
<p>发送网络请求</p>
<h3 id="建立-tcp-链接-三次握手"><a class="markdownIt-Anchor" href="#建立-tcp-链接-三次握手"></a> 建立 TCP 链接 三次握手</h3>
<h3 id="发送-http-请求"><a class="markdownIt-Anchor" href="#发送-http-请求"></a> 发送 HTTP 请求</h3>
<p>options 请求，在其他请求之前发送</p>
<blockquote>
<p>post 请求格式为 application/json 格式才会触发 options</p>
<p>触发 options</p>
<ol>
<li>跨域，options 请求预先检测</li>
<li>自定义请求头</li>
</ol>
</blockquote>
<h3 id="浏览器缓存"><a class="markdownIt-Anchor" href="#浏览器缓存"></a> 浏览器缓存</h3>
<p>强缓存 浏览器强制缓存服务端的数据（静态资源）</p>
<blockquote>
<p><code>res.setHeader('Cache-Control', 'max-age=10')</code>或者设置 <code>res.setheader(expires GMT时间))</code></p>
<p>form disk cahce 磁盘缓存服务端的资源</p>
<p>from memory cache 内存缓存服务端资源 ，多次刷新，就读内存里的</p>
</blockquote>
<p>协商缓存</p>
<blockquote>
<p>Last-Modified GMT 时间 <mark>最后更改时间</mark></p>
<p>if-Modified-Since</p>
<p>如果前后时间(或 xxx 字段)是一致的那么就代表资源没有改变，后端返回 304，</p>
<p>变了代表资源改变，后端返回新的资源，返回 200</p>
<p>ETAG:‘xxx’ (文件 hash，or 版本号) <mark>唯一标识符，用于标识特定版本的资源</mark></p>
<p>if-None-Match</p>
</blockquote>
<h3 id="tcp-断链-4-次挥手"><a class="markdownIt-Anchor" href="#tcp-断链-4-次挥手"></a> TCP 断链 4 次挥手</h3>
<h3 id="html-渲染"><a class="markdownIt-Anchor" href="#html-渲染"></a> HTML 渲染</h3>
<p>html 解析器 解析标签为 DOM 树</p>
<p>样式计算</p>
<blockquote>
<p>渲染引擎格式化计算 css 样式(rem-&gt;px bold-&gt;700…) CSSOM 构建</p>
</blockquote>
<p>回流</p>
<blockquote>
<p>计算得到几何信息、大小</p>
</blockquote>
<blockquote>
<p><em>触发回流</em></p>
<ol>
<li>首次渲染</li>
<li>resize</li>
<li>跟大小宽高有关的改变</li>
<li>hover</li>
<li>js 获取 clientWidth</li>
</ol>
</blockquote>
<p>重绘</p>
<blockquote>
<p>元素样式的改变并不影响它在文档流中的位置(color backgoroung-color,visibility)，浏览器将新样式给他并重新绘制</p>
</blockquote>
<p>GPU 渲染</p>
<p>v8 解析 js</p>
<p>渲染树？？</p>
<h2 id="07-tcp-http"><a class="markdownIt-Anchor" href="#07-tcp-http"></a> 07 TCP HTTP</h2>
<p>OSI 七层</p>
<p>应用层 （应用进程之间的交互规则） 万维网 HTTP 邮件 SMTP 域名系统 DNS</p>
<p>表示层 （通信的应用程序能够<strong>解释交换数据的含义</strong>）</p>
<p>会话层 （建立、管理和终止<strong>表示层实体之间的通信会话</strong>）</p>
<p>传输层 （为<strong>进程之间的通信提供服务</strong>，处理数据包错误、数据包次序，以及其他）<strong>TCP UDP</strong></p>
<p>网络层 （选择合适的网间<strong>路由和交换节点</strong>，确保数据按时成功传送）</p>
<p>数字链路层 （两台主机之间的数据传输，总是在一段一段的链路上传送的，<strong>将 IP 数据组合成帧，相邻节点传输帧</strong>）</p>
<p>物理层 （定义传输媒介）</p>
<p>All People need data processing</p>
<h2 id="08-vue"><a class="markdownIt-Anchor" href="#08-vue"></a> 08 VUE</h2>
<p>v-if 切换有一个局部编译/卸载的过程，切换过程中合适的销毁和重建内部事件监听和子组件，v-show 只是简单的进行 css 的切换</p>
<blockquote>
<p>vif 切换消耗</p>
<p>Vshow 初始渲染消耗</p>
</blockquote>
<h2 id="09-定义列表"><a class="markdownIt-Anchor" href="#09-定义列表"></a> 09 定义列表</h2>
<p>自定义</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>有序</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1111<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2222<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>无序</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>11111<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>22222<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>选择框—分组</p>
<p><img src="https://s2.loli.net/2024/03/25/X4xb3CE5jMaNDsd.png" alt="image-20231007174223914" /></p>
<p>filedset legend</p>
<p><img src="https://s2.loli.net/2024/03/25/7TWLP8xkglwQc1i.png" alt="image-20231007174412245" /></p>
<h2 id="10-拖拽"><a class="markdownIt-Anchor" href="#10-拖拽"></a> 10 拖拽</h2>
<p><img src="https://s2.loli.net/2024/03/25/bt843AozKdD7Fi5.png" alt="image-20230524160915054" /></p>
<h2 id="11-和"><a class="markdownIt-Anchor" href="#11-和"></a> 11 <code>==</code>和<code>===</code></h2>
<h3 id=""><a class="markdownIt-Anchor" href="#"></a> <code>==</code></h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 双等号隐式类型转换 ALL true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">100</span> == <span class="string">&quot;100&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> == <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&quot;</span> == <span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="literal">null</span> == <span class="literal">undefined</span>)</span><br></pre></td></tr></table></figure>
<h3 id="开发尽量使用"><a class="markdownIt-Anchor" href="#开发尽量使用"></a> 开发尽量使用<code>===</code>，</h3>
<p>但是这种情况可以，两者等价 <code>obj==null</code> 与<code>obj===null || obj===undefined</code></p>
<h2 id="12-闭包"><a class="markdownIt-Anchor" href="#12-闭包"></a> 12 闭包</h2>
<p><font color=red>指函数和其周围的状态（即词法环境）的组合，作用域的特殊运用</font></p>
<p>内部函数总是可以访问其所在的外部函数中声明的参数和变量，即使在其外部函数被返回（寿命终结）了之后</p>
<h3 id="自由变量"><a class="markdownIt-Anchor" href="#自由变量"></a> 自由变量</h3>
<p>在闭包函数中使用但<strong>不是在该函数作用域</strong>内声明的变量</p>
<p>自由变量的值：在<strong>函数定义</strong>的地方向上层寻找，与函数调用的地方无关</p>
<h4 id="以下是一些常见的触发闭包的情况"><a class="markdownIt-Anchor" href="#以下是一些常见的触发闭包的情况"></a> 以下是一些常见的触发闭包的情况：</h4>
<ol>
<li>函数嵌套：内部函数可以访问外部函数的变量，导致形成了闭包。</li>
<li>函数作为返回值：如果一个函数返回了一个内部函数，那么该内部函数可以访问到外部函数的变量，从而形成闭包。</li>
</ol>
<p>​</p>
<ol>
<li>事件监听：如果在事件监听函数内部定义了函数，那么该内部函数可以访问到事件监听函数的变量，形成闭包。</li>
<li>延迟调用：如果在一个函数内部调用了另外一个函数，并且该函数有一个定时器或者是回调函数，那么该回调函数可以访问到外部函数的变量，形成闭包。</li>
<li>IIFE（立即调用的函数表达式）：如果在一个函数内部定义了一个函数并立即调用，那么该内部函数可以访问到外部函数的变量，形成闭包。</li>
</ol>
<h2 id="13-防抖节流"><a class="markdownIt-Anchor" href="#13-防抖节流"></a> 13 防抖节流</h2>
<p><font color=red>事件被频繁触发时，减少事件执行的次数</font></p>
<h3 id="防抖-debounce"><a class="markdownIt-Anchor" href="#防抖-debounce"></a> 防抖 Debounce</h3>
<p>在事件被触发 n 秒后再执行回调，如果在这 n 秒内又被触发，则重新计时。(input 输入，resize )</p>
<p><img src="https://s2.loli.net/2024/03/25/KdzxpNmlB4w7MQE.png" alt="image-20230403104255692" /></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ipt&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> ipt = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#ipt&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">  ipt.<span class="title function_">addEventListener</span>(</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;keyup&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">debounce</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(ipt.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  )</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> timer = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (timer) <span class="built_in">clearTimeout</span>(timer)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span></span><br><span class="line"><span class="language-javascript">        timer = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="节流-throttle"><a class="markdownIt-Anchor" href="#节流-throttle"></a> 节流 Throttle</h3>
<p>规定在一个单位时间内，只能触发一次函数。如果这个单位时间内触发多次函数，只有一次生效。（拖拽、scoll）</p>
<p><img src="https://s2.loli.net/2024/03/25/yGBE2tDsi1QVarZ.png" alt="image-20230403104138541" /></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;box1&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">draggable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">&quot;background-color: red; width: 100px;height: 100px;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> box1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box1&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">  box1.<span class="title function_">addEventListener</span>(</span></span><br><span class="line"><span class="language-javascript">    <span class="string">&quot;drag&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">throttle</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">clientX</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  )</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> timer = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (timer) <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">      timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span></span><br><span class="line"><span class="language-javascript">        timer = <span class="literal">null</span></span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="14-浏览器相关"><a class="markdownIt-Anchor" href="#14-浏览器相关"></a> 14 浏览器相关</h2>
<p>l 进程：一个程序的运行<strong>实例</strong></p>
<p>运行一个程序，操作系统会创建一块内存， 给代码和运行时的数据使用 ，并且创建一个<strong>线程</strong>来处理任务</p>
<p>线程是 一个进程的执行任务或者控制单元，负责当前进程中程序的执行</p>
<p>一个进程<u>至少</u>有一个线程，多个线程可以进行数据的共享</p>
<img src="./笔记.assets/image-20230405223549096.png" alt="image-20230405223549096" style="zoom:33%;" />
<p>特点：</p>
<ol>
<li>一个线程崩溃，整个进程崩溃</li>
<li>同一进程中，线程可以数据共享</li>
<li>进程关闭后，内存会正确回收</li>
</ol>
<p>普通单线程浏览器</p>
<ul>
<li>不稳定，</li>
<li>容易卡，</li>
<li>内存泄漏（所有页面在一个进程中，单个页面因为代码编写问题数据泄露。关闭页面时，泄露的内存不会回收）</li>
<li>安全问题（插件和渲染线程拥有很高权限，各种脚本代码（通常第三方编写））</li>
</ul>
<img src="./笔记.assets/image-20230405224432228.png" alt="image-20230405224432228" style="zoom:33%;" />
<p>Chrome 多线程</p>
<p>每个页面单独渲染进程和插件进程，装进沙箱，不能获取系统权限</p>
<p>权限由浏览器主线程操作</p>
<img src="./笔记.assets/image-20230405234925822.png" alt="image-20230405234925822" style="zoom: 25%;" />
<img src="./笔记.assets/image-20230405235048594.png" alt="image-20230405235048594" style="zoom:33%;" />
<p>主进程：页面的展示，页面的交互，管理子进程，提供存储功能</p>
<p>网络进程：下载网络资源</p>
<p>GPU 进程：绘制网页和 UI 界面</p>
<p>渲染进程：js v8 引擎，排版引擎 Blink （h5 css js 转换为网页）</p>
<h3 id="网络协议"><a class="markdownIt-Anchor" href="#网络协议"></a> 网络协议</h3>
<p>互联网协议 Internet protocol IP</p>
<p>网络层协议</p>
<p>计算机系统通过 ip 协议在网络中互相传输数据</p>
<p>IP 不好记 ----&gt; 域名</p>
<p>DNS 域名系统 Domain name system</p>
<p>找到具体服务器的系统服务器的 IP 地址，如何指定访问具体程序</p>
<p>​ UDP 用户数据包协议 user datagram protocol 端口号访问指定的程序 <font color=red>传输层协议</font></p>
<p>​ UDP 协议发送数据时，不能保证接收端一定收到</p>
<p>​ TCP 数据传输（控制）协议 transmission control protocol <font color=red>传输层协议  </font></p>
<p>​ 将数据拆分成数据包的形式传输</p>
<p>​ 数据包的丢失，提供重传的机制</p>
<p>​ <font color=blue>面向连接</font>，在传输数据之前，他会和目标设备进行连接，在传输完成后和目标断开连接 （创建和断开的过程，三次握手，四次挥手）</p>
<table>
<thead>
<tr>
<th style="text-align:center">特性</th>
<th style="text-align:center">TCP</th>
<th style="text-align:center">UDP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">连接方式</td>
<td style="text-align:center">有连接</td>
<td style="text-align:center">无连接</td>
</tr>
<tr>
<td style="text-align:center">可靠性保证</td>
<td style="text-align:center">提供可靠性保证</td>
<td style="text-align:center">不提供可靠性保证</td>
</tr>
<tr>
<td style="text-align:center">传输数据顺序保证</td>
<td style="text-align:center">传输数据顺序得到保证</td>
<td style="text-align:center">不保证传输数据顺序</td>
</tr>
<tr>
<td style="text-align:center">传输数据开销较大</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center">适用场景</td>
<td style="text-align:center">适用于数据传输要求可靠的应用程序，如文件传输、电子邮件等</td>
<td style="text-align:center">适用于数据传输速度要求快的应用程序，如在线游戏、实时视频和音频通信等</td>
</tr>
</tbody>
</table>
<h3 id="tcp"><a class="markdownIt-Anchor" href="#tcp"></a> TCP 🤝👋🏻</h3>
<p><strong>三次握手(建立连接)</strong></p>
<p>​ 1. 客户端请求连接的请求 SYN，<font color=blue>随机起始序列号 Sequence Number</font> 给 服务端</p>
<p>​ 2. 服务端接受到请求，发送<u>确认信息 ACK</u>、SYN（伴随<font color=red>随机起始序列号</font>）、客户端发送来的<font color=blue><u>序列号+1</u></font>（aka<u>确认序列号 Acknowledgement Number</u>）</p>
<p>​ 3. 客户端收到服务器的 SYN 和 ACK，向服务器发送一个 ACK 确认信息（<font color=red>服务器随机序列号+1</font>）</p>
<p>通过握手过程，TCP 协议可以保证连接的可靠性和正确性，同时还可以进行流量控制和拥塞控制，以确保网络的稳定性和可靠性。</p>
<p><strong>四次挥手 （关闭连接）</strong></p>
<ol>
<li>🅰️ 发送一个 FIN 消息，表示没有数据传输，但 🆎 双方仍可接受数据</li>
<li>🅱️ 接受到 FIN，向对方发送 ACK，表示已经接受到该消息</li>
<li>🅱️ 也发送一个 FIN 消息，表示数据全部传输完毕，但 🆎 双方 🈲 不可发送数据</li>
<li>🅰️ 收到 FIN，返回一个 ACK 消息，表示已经接受到该消息</li>
</ol>
<p>通过挥手过程，TCP 协议可以保证数据的完整性和可靠性，在数据传输结束后及时关闭连接，释放资源，以便其他应用程序可以使用它们。</p>
<h3 id="规定传输格式"><a class="markdownIt-Anchor" href="#规定传输格式"></a> 规定传输格式</h3>
<p>浏览器 http 协议</p>
<p>http 请求流程</p>
<p>​ url 给我网页数据 查找缓存（存在且没过期，暂停请求 网页更快加载，减轻服务器压力</p>
<p>​ 没有缓存，http 做应用层协议，tcp ip 发送到网络中（之前通过域名获取 IP 地址，找到缓存，下次直接使用对应 ip,访问域名没有加端口，默认加:80(http 默认端口)</p>
<p>​ 为 TCP 建立连接做 3 次握手，完成 发送 http 请求 ||服务端接受返回数据</p>
<h4 id="输入-url-到页面展示"><a class="markdownIt-Anchor" href="#输入-url-到页面展示"></a> 输入 URL 到页面展示</h4>
<ol>
<li>
<p>浏览器判断输入的内容，不符合 URL 规则，内置搜索引擎搜索；符合规则，加上协议</p>
</li>
<li>
<p>请求阶段：浏览器主进程 =<u>URL(进程之间通信)</u> =&gt; 网络进程=（转圈，接受服务器返回的 http 相应头 html）,让浏览器开启一个渲染进程，发送一个提交文档命令。</p>
<p>网络进程=（HTTP 文档）=&gt; 渲染进程</p>
</li>
</ol>
<p>​ <img src="./笔记.assets/image-20230406143157791.png" alt="image-20230406143157791" style="zoom:25%;" /></p>
<p>​</p>
<p>渲染完毕 ，接受完毕指令，当前页面白屏</p>
<img src="./笔记.assets/image-20230406143342974.png" alt="image-20230406143342974" style="zoom:25%;" />
<p>渲染进程联合 GPU 进程渲染，并返回</p>
<img src="./笔记.assets/image-20230406143530487.png" alt="image-20230406143530487" style="zoom:25%;" />
<p>网络进程 ?缓存资源(返回给浏览器主进程，中断请求)</p>
<p>​ 没有，进入网络流程</p>
<p>​ DNS 解析 ip 地址</p>
<p>同一站点（根域名，协议相同 ）公用一条渲染进程</p>
<p><img src="./%E7%AC%94%E8%AE%B0.assets/image-20230406144818544.png" alt="image-20230406144818544" /></p>
<h2 id="15-面向对象"><a class="markdownIt-Anchor" href="#15-面向对象"></a> 15 面向对象</h2>
<p><strong>类的封装、继承、多态</strong></p>
<ul>
<li>
<p>封装：低内聚高耦合</p>
</li>
<li>
<p>多态：重载和重写</p>
</li>
</ul>
<p>​ 重载：方法名相同，形参个数或者类型不一样</p>
<p>​ JS 中不存在真正意义上的重载，JS 重载指的是使用同一个方法，根据传参不同，实现不同的效果</p>
<p>JS 中的面向对象是基于原型和原型链的</p>
<ul>
<li>继承：子类继承父类的方法</li>
</ul>
<h3 id="js-继承"><a class="markdownIt-Anchor" href="#js-继承"></a> <strong>JS 继承：</strong></h3>
<ul>
<li><strong>原型继承</strong>
<ul>
<li>优点：父类方法可以被复用</li>
<li>缺点：1. 父类的<strong>引用类型</strong>数据会被子类共享篡改 2. <u>子类实例不能给给父类构造函数传参</u></li>
</ul>
</li>
<li><strong>call 继承</strong> 借用构造函数
<ul>
<li>优点：父类的<strong>引用类型</strong>数据不会被子类共享篡改</li>
<li>缺点：不能访问父类原型属性上的方法</li>
</ul>
</li>
<li>**组合继承（**原型继承和 call 继承的结合）
<ul>
<li>优点：
<ul>
<li>父类方法复用</li>
<li>父类引用数据不会被子类共享篡改</li>
<li>子类可以访问父类原型上的方法</li>
</ul>
</li>
<li>缺点：
<ul>
<li>会调用两次父类的数据，会有两份一样的属性和方法，影响性能</li>
</ul>
</li>
</ul>
</li>
<li><strong>寄生组合继承</strong>
<ul>
<li>优点
<ul>
<li>改变以上优缺点</li>
</ul>
</li>
<li>
<h2 id="缺点"><a class="markdownIt-Anchor" href="#缺点"></a> 缺点</h2>
</li>
</ul>
</li>
<li>ES6 extends、super</li>
</ul>
<h2 id="16-判断数据类型"><a class="markdownIt-Anchor" href="#16-判断数据类型"></a> 16 判断数据类型</h2>
<p><code>typeof </code></p>
<p>Array Object null 都是返回 object 类型 (set、map 也是 object，symbol 返回 symbol)</p>
<p><mark><code>Object.prototype.toString.call()</code> 都可以区分 [] {} null</mark></p>
<h2 id="17-手写代码"><a class="markdownIt-Anchor" href="#17-手写代码"></a> 17 手写代码</h2>
<h3 id="instanceof"><a class="markdownIt-Anchor" href="#instanceof"></a> instanceof</h3>
<p><strong><code>instanceof</code></strong> <strong>运算符</strong>用于检测构造函数的 <code>prototype</code> 属性是否出现在某个实例对象的原型链上。</p>
<p>判断继承关系，在同一条原型链上，返回 true</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myInstanceof</span>(<span class="params">obj1, obj2</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> objProto = obj1.<span class="property">__proto__</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (objProto === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">if</span> (objProto === obj2.<span class="property"><span class="keyword">prototype</span></span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 一层一层往上找</span></span><br><span class="line">    objProto = objProto.<span class="property">__proto__</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="bind"><a class="markdownIt-Anchor" href="#bind"></a> bind</h3>
<p><img src="https://s2.loli.net/2024/03/25/iGepJNhtcAM5ZsF.png" alt="image-20230403201715838" /></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(this) //fn函数</span></span><br><span class="line">  <span class="keyword">const</span> fn = <span class="variable language_">this</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> arg = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>)</span><br><span class="line">  <span class="keyword">const</span> _this = arg.<span class="title function_">shift</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">apply</span>(_this, arg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">myBind</span> = <span class="keyword">function</span> (<span class="params">context, ...args</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = <span class="variable language_">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">apply</span>(context, [...args, ...<span class="variable language_">arguments</span>])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="深拷贝"><a class="markdownIt-Anchor" href="#深拷贝"></a> 深拷贝</h3>
<ul>
<li></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要注意的是，在一些复杂的对象中，比如包含<strong>函数、正则表达式、日期等类型</strong>的对象时，使用<code>JSON.parse(JSON.stringify(obj))</code>可能会导致数据丢失或类型错误，因为<strong>这些类型的对象不能被序列化为 JSON 字符串</strong>。这时候需要采用其他的深度复制方法，比如手动递归复制、使用第三方库等。</p>
<ul>
<li>递归
<ul>
<li>(没有考虑循环引用) 如果对象 A 引用了对象 B，而对象 B 又引用了对象 A，那么在进行深拷贝的时候会陷入死循环。（哈希表）</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&quot;object&quot;</span> || obj == <span class="literal">null</span>) <span class="keyword">return</span> obj</span><br><span class="line">  <span class="keyword">let</span> res = obj <span class="keyword">instanceof</span> <span class="title class_">Array</span> ? [] : &#123;&#125;</span><br><span class="line">  <span class="comment">//  for in会遍历到obj原型链上的属性，增加判断，健壮性</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">if</span> (obj.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">      <span class="comment">// 嵌套的一层不会被克隆，所以再加一次深度克隆</span></span><br><span class="line">      res[key] = <span class="title function_">deepClone</span>(obj[key])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>lodash.cloneDeep()</code></li>
</ul>
<h3 id="扁平化数组"><a class="markdownIt-Anchor" href="#扁平化数组"></a> 扁平化数组</h3>
<p>借助 Array.prototype.concat.apply([], arr)</p>
<h2 id="18-预编译"><a class="markdownIt-Anchor" href="#18-预编译"></a> 18 预编译</h2>
<h3 id="js-预编译"><a class="markdownIt-Anchor" href="#js-预编译"></a> JS 预编译</h3>
<p>js 属于解释性语言，在执行过程中顺序执行，但是会分块先预编译再执行。因此 JS 存在一种变量提升的现象。</p>
<p><strong>但是是因为有预编译才有 所谓的变量提升</strong></p>
<h4 id="函数先于变量提升"><a class="markdownIt-Anchor" href="#函数先于变量提升"></a> 函数先于变量提升</h4>
<h5 id="变量提升"><a class="markdownIt-Anchor" href="#变量提升"></a> 变量提升</h5>
<p>var 声明变量提升、function 声明函数提升</p>
<p>无论这两者声明或调用的位置是前是后，系统总是会将其提升到调用前面，因此只值为 undefined</p>
<h5 id="js-代码运行的三大步骤"><a class="markdownIt-Anchor" href="#js-代码运行的三大步骤"></a> JS 代码运行的三大步骤</h5>
<ol>
<li>词法分析</li>
<li>预编译</li>
<li>解释执行</li>
</ol>
<h5 id="暗示全局变量-imply-global"><a class="markdownIt-Anchor" href="#暗示全局变量-imply-global"></a> 暗示全局变量 imply global</h5>
<p>任何变量，<font color=red>未经声明就赋值</font>，此变量为<strong>全局</strong>所有</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  a = <span class="number">100</span></span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">console</span>.<span class="title function_">log</span>(a, <span class="variable language_">window</span>.<span class="property">a</span>)) <span class="comment">//100 100</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">   <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">     b = <span class="number">200</span></span></span><br><span class="line"><span class="language-javascript">   &#125;</span></span><br><span class="line"><span class="language-javascript">   <span class="title function_">test</span>()</span></span><br><span class="line"><span class="language-javascript">   <span class="variable language_">console</span>.<span class="title function_">log</span>(b, <span class="variable language_">window</span>.<span class="property">b</span>) <span class="comment">//200 200</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>、、、、、在 ES5 下、、、、、</p>
<h5 id="global-object-和-activition-object"><a class="markdownIt-Anchor" href="#global-object-和-activition-object"></a> Global Object 和 Activition Object</h5>
<p>所谓的全局作用域，局部作用域</p>
<blockquote>
<ol>
<li>创建 GO 对象</li>
<li>寻找变量声明 var，值设定为 undefined</li>
<li>寻找函数声明，将函数名作为 GO 属性名，值为函数体</li>
</ol>
</blockquote>
<blockquote>
<ol>
<li>创建 AO 对象</li>
<li>寻找函数的<strong>形参</strong>和<strong>变量声明</strong>var，将变量和形参名作为 AO key，value 为 undefined</li>
<li>统一形参和实参，即更改形参后的 undefined 为实参值</li>
<li>寻找函数声明，将函数作为 AO key，value 为函数体</li>
</ol>
</blockquote>
<p>匿名函数、函数表达式不参与预编译</p>
<p><img src="https://s2.loli.net/2024/03/25/uCr87YZGxmKEwqi.png" alt="image-20230330165816238" /></p>
<p><img src="https://s2.loli.net/2024/03/25/xetFnNd1LAZo9Ec.png" alt="image-20230330190058698" /></p>
<p><img src="./%E7%AC%94%E8%AE%B0.assets/image-20230330190037506.png" alt="image-20230330190037506" /></p>
<p>ES6 新增的块级作用域</p>
<hr />
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//1</span></span><br><span class="line">  c = <span class="number">0</span></span><br><span class="line">  <span class="keyword">var</span> c</span><br><span class="line">  a = <span class="number">3</span></span><br><span class="line">  b = <span class="number">2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//2</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">d</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">test</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>预编译</p>
<p>AO：{</p>
<p>​ a:<s>undefined</s> 1</p>
<p>​ b:<s>undefined</s> fn</p>
<p>​ c:undefined</p>
<p>​ d: fn</p>
<p>}</p>
<p>执行</p>
<p>AO：{</p>
<p>​ a:<s>undefined</s> <s>1</s> 3</p>
<p>​ b:<s>undefined</s> <s>fn</s> 2</p>
<p>​ c:<s>undefined</s> 0</p>
<p>​ d: fn</p>
<p>}</p>
</blockquote>
<hr />
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//fn a</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//udefined</span></span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">1</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//1</span></span><br><span class="line">  a = <span class="number">2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//2</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="keyword">var</span> a</span><br><span class="line">  b = <span class="number">3</span></span><br><span class="line">  <span class="keyword">var</span> b = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//fn</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>预编译</p>
<p>AO：{</p>
<p>​ a:<s>undefined</s> <s>1</s> fn</p>
<p>​ b:undefined</p>
<p>}</p>
<p>执行</p>
<p>AO：{</p>
<p>​ a:<s>undefined</s> <s>1</s> <s>fn</s> 2</p>
<p>​ b:<s>undefined</s> <s>1</s> <s>3</s> fn</p>
<p>}</p>
</blockquote>
<hr />
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">100</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">e</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="variable language_">arguments</span>[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e) <span class="comment">//2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">// undefined</span></span><br><span class="line">  <span class="keyword">if</span> (a) &#123;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">123</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">c</span>(<span class="params"></span>) &#123;&#125; <span class="comment">//在if语句里面不声明（块级作用域）</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> c</span><br><span class="line">  <span class="keyword">var</span> a</span><br><span class="line">  a = <span class="variable language_">arguments</span>[<span class="number">1</span>]</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//2</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(b) <span class="comment">//undefined</span></span><br><span class="line">  f = <span class="number">456</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(c) <span class="comment">//undefined</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(f) <span class="comment">//456</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a</span><br><span class="line"><span class="title function_">test</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a) <span class="comment">//100</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(f) <span class="comment">//456</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>预编译</p>
<p>AO：{</p>
<p>​ e:<s>undefined</s> <s>1</s> fn(e)</p>
<p>​ b: undefined</p>
<p>​ c: undefined</p>
<p>​ a:undefined</p>
<p>}</p>
<p>GO:{</p>
<p>​ a: undefined</p>
<p>​ test: fn</p>
<p>}</p>
<p>执行</p>
<p>AO：{</p>
<p>​ e:<s>undefined</s> <s>1</s> <s>fn(e)</s> 2</p>
<p>​ b: undefined</p>
<p>​ c: undefined</p>
<p>​ a:<s>undefined</s> 2</p>
<p>}</p>
<p>GO:{</p>
<p>​ a: <s>undefined</s> 100</p>
<p>​ test: fn</p>
<p>}</p>
</blockquote>
<h2 id="19-for-in-of"><a class="markdownIt-Anchor" href="#19-for-in-of"></a> 19 <code>for in of</code></h2>
<h4 id="for-in-遍历得到-key"><a class="markdownIt-Anchor" href="#for-in-遍历得到-key"></a> For in 遍历得到 key</h4>
<ul>
<li>可枚举的数据 (<code>Object.getOwnPropertyDescriptors()</code>)</li>
</ul>
<p>​ 数组、字符串、对象</p>
<p><font color=red><code>for...in</code> 循环可以遍历对象的可枚举属性，包括自有属性和继承属性。但是需要注意的是，它不能保证属性的遍历顺序，而且会遍历对象的原型链上的属性，所以需要使用 <code>hasOwnProperty()</code> 方法来判断属性是否为自有属性。</font></p>
<h4 id="for-of-遍历得到-value"><a class="markdownIt-Anchor" href="#for-of-遍历得到-value"></a> for of 遍历得到 value</h4>
<ul>
<li>可迭代的数据 (<code>arr[Symbol.iterator]()</code>)</li>
</ul>
<p>​ 数组、字符串、set、map</p>
<h4 id="for-await-of"><a class="markdownIt-Anchor" href="#for-await-of"></a> For await of</h4>
<p>遍历一组 Promise</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">generatePromise</span>(<span class="params">num</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">resolve</span>(num)</span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p1 = <span class="title function_">generatePromise</span>(<span class="number">1</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p2 = <span class="title function_">generatePromise</span>(<span class="number">2</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p3 = <span class="title function_">generatePromise</span>(<span class="number">3</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> p4 = <span class="title function_">generatePromise</span>(<span class="number">4</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> list = [p1, p2, p3, p4]</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 如何一下子拿到所有结果</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/*     (async function()&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        for await(let val of list)&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">            console.log(val) //1,2,3,4一行一行打印</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        &#125;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    &#125;)()</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript"></span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    Promise.all(list).then(res=&gt;&#123;</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res) //[1,2,3,4] 返回数组结果</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    &#125;) */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 如和一步一步拿到结果</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span></span><br><span class="line"><span class="language-javascript">  ;(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> val <span class="keyword">of</span> data) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">generatePromise</span>(val)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;??&quot;</span>, res)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/* const res1 = await generatePromise(data[0])</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res1)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        const res2 = await generatePromise(data[1])</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res2)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        const res3 = await generatePromise(data[2])</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res3)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        const res4 = await generatePromise(data[3])</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res4)</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        const res5 = await generatePromise(data[4])</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        console.log(res5) */</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="20-js-类型转换"><a class="markdownIt-Anchor" href="#20-js-类型转换"></a> 20 JS 类型转换</h2>
<p>js 是动态类型语言，我们在定义一个变量其实并没有指定这个变量到底属于那种类型，只有到程序执行阶段才确定当前数据类型。</p>
<p>而<font color=red>各种<strong>运算符</strong>对数据类型是有要求的</font>，所以就会触发类型转换机制（no matter 人为 or 隐式触发）</p>
<h3 id="显示转换"><a class="markdownIt-Anchor" href="#显示转换"></a> 显示转换：</h3>
<p>​ 通过 JS 内置的函数<strong>明确转换的数据类型</strong></p>
<ul>
<li>
<p>Number</p>
</li>
<li>
<p>parseInt(string, ?进制) 比 Number 宽松，一位一位解析遇到不能解析的停止</p>
</li>
<li>
<p>String</p>
</li>
<li>
<p>Boolean</p>
</li>
</ul>
<h3 id="隐式转换"><a class="markdownIt-Anchor" href="#隐式转换"></a> 隐式转换：</h3>
<p>​ 运算操作符两边数据类型不一致（比较运算符、算术运算符）</p>
<ul>
<li>
<p>转为 Boolean (需要布尔值的地方，借助的<code>Boolean()</code>函数)</p>
<ul>
<li>falsely 变量：<code>undefined</code>、<code>null</code>、<code>false</code>、<code>+/-0</code>、<code>NAN</code>、<code>&quot;&quot;</code></li>
</ul>
</li>
<li>
<p>转为 String （复合类型—&gt;原始类型----&gt;字符串）</p>
<ul>
<li>常发生在 <code>&quot;5&quot; + xxx</code> 加法运算符号</li>
</ul>
</li>
<li>
<p>转为 Number</p>
<ul>
<li>除了加法运算符号，其他都有可能</li>
</ul>
</li>
</ul>
<h3 id="other"><a class="markdownIt-Anchor" href="#other"></a> other</h3>
<blockquote>
<p><code>=== </code>在不进行类型转换情况下，双方的类型与值都相等</p>
</blockquote>
<h2 id="21-js-事件机制"><a class="markdownIt-Anchor" href="#21-js-事件机制"></a> 21 JS 事件机制</h2>
<p>事件</p>
<p>就是 html 文档与浏览器的一些交互操作，使网页具备互动性</p>
<p>由于<strong>DOM</strong>是一个<strong>树</strong>结构，如果在<strong>父子节点绑定事件</strong>时候，当触发<strong>子节点</strong>的时候，就存在一个<strong>顺序问题</strong>，这就涉及到了**<u>事件流</u>**的概念</p>
<p><strong><em>捕获 目标 冒泡</em></strong></p>
<img src="https://s2.loli.net/2024/03/25/7IP1hs6lGbOHMjW.png" alt="image-20230518210314566" style="zoom:50%;" />
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">addEventLisener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;&#125;, <span class="literal">false</span>) <span class="comment">//默认false，不在捕获阶段执行</span></span><br><span class="line"></span><br><span class="line">event.<span class="title function_">preventPropagation</span>() <span class="comment">//阻止在冒泡阶段执行</span></span><br></pre></td></tr></table></figure>
<p>click 事件 冒泡</p>
<h2 id="22-js-异步机制"><a class="markdownIt-Anchor" href="#22-js-异步机制"></a> 22 JS 异步机制</h2>
<h3 id="js-异步编程"><a class="markdownIt-Anchor" href="#js-异步编程"></a> JS 异步编程</h3>
<p>单线程</p>
<p>DOM 操作，必须要使用单线程模型，否则出现多线程同步问题（一个线程增，一个线程删，麻烦）</p>
<p>假如说只用同步来解决，即排队执行代码，那么则简单、安全。但是遇到一段非常耗时的代码段，导致整个程序被拖延，导致假死（阻塞）情况。所以 JS 带来<u>同步</u>模式<u>异步</u>模式来解决此问题。</p>
<ul>
<li>同步模式与异步模式</li>
<li>事件循环与消息队列</li>
<li>异步编程几种方式</li>
<li>Promise 异步方案、宏任务/微任务队列 （ES2015）</li>
<li>Generator 异步方案（ES2015），Async/Await 语法糖（ES2017）</li>
</ul>
<h3 id="同步模式与异步模式"><a class="markdownIt-Anchor" href="#同步模式与异步模式"></a> 同步模式与异步模式</h3>
<p><strong><font color=red>同步模式</font></strong></p>
<p><u>排队一步一步执行</u></p>
<p>开始执行 JS 引擎将全部代码加载进来，<code>call stack</code>压入一个<code>(anonymous)</code> （全部代码放入匿名函数中执行，<code>call stack</code>是调用栈，函数声明不会压入栈中）</p>
<p><strong><font color=red>异步模式</font></strong></p>
<p>不会等待这个任务结束，才开始下一个任务。开启过后，立即开始下一个任务。后续逻辑一般会通过<strong>回调函数</strong>的方式定义</p>
<p><em>代码执行顺序混乱？？</em></p>
<p>倒计时器根本不会管 call stack 和 Queue，放在 WebAPI 中</p>
<p>call stack 正在执行的工作表</p>
<p>Queue 待办工作表</p>
<p>Event Loop 监听 call stack 和 Queue，</p>
<p>一旦 call stack 任务结束，事件循环会从 Queue 中取出第一个回调函数压入到 call stack</p>
<img src="https://s2.loli.net/2024/03/25/icy4GVaP2uew3fp.png" alt="image-20230403162215658" style="zoom:50%;" />
<img src="https://s2.loli.net/2024/03/25/Nqmv6TrSUJFxVjO.png" alt="image-20230403162615098" style="zoom:50%;" />
<img src="https://s2.loli.net/2024/03/25/8NHPdJlVshjn1wz.png" alt="image-20230403162834422" style="zoom:35%;" />
<p>JS 单线程，是指执行代码是单线程的，但浏览器并不是单线程。</p>
<p>而我们所说的同步异步问题是指<strong>运行环境提供的 API 是以同步或异步模式的方式工作</strong></p>
<h3 id="回调函数"><a class="markdownIt-Anchor" href="#回调函数"></a> 回调函数</h3>
<p>所有异步编程方案的根基</p>
<p>理解为：<code>一件你想要做的事---&gt;但不知道这件事所依赖的事情什么时候结束---&gt;交给异步任务执行者，他知道</code></p>
<p>​ <strong>调用者定义 交给执行者执行</strong></p>
<p><em><font color=gray>事件机制、发布订阅基于回调</font></em></p>
<h3 id="promise"><a class="markdownIt-Anchor" href="#promise"></a> Promise</h3>
<p>一种更优秀的异步编程统一方案（CommonJS 社区提出，被纳入 ES2015）</p>
<p><img src="https://s2.loli.net/2024/03/25/L3nQBlK6ejMhGgy.png" alt="image-20230329145634209" /></p>
<p>明确成功或失败的<u>结果</u>（不可被修改）后，都会有相应的任务自动执行。</p>
<h4 id="链式调用不是通过函数-return-this-达到的链式调用"><a class="markdownIt-Anchor" href="#链式调用不是通过函数-return-this-达到的链式调用"></a> 链式调用（不是通过函数 return this 达到的链式调用）</h4>
<p><code>.then( )方法</code> 返回的是全新的 Promise 对象 （返回</p>
<p>每一个 then 方法实际上都是为上一个 then 返回的 Promise 对象添加状态明确的回调</p>
<ul>
<li>
<p>Promise 的 then 方法返回一个<font color=yellowgreen>全新</font>的 Promise 对象（所以可以采用.then 链式调用）</p>
<ul>
<li>.then 后面会返回一个新的 promise 实例，又可以继续调用 then 或者 catch 方法</li>
</ul>
</li>
<li>
<p>后面的 then 方法就是在为上一个 then 方法返回的 Promise 对象注册回调（添加状态明确的回调）</p>
</li>
<li>
<p>前面 then 方法 return 的返回值会作为下一个 then 方法回调的参数</p>
<ul>
<li>如果 return 的是 Promise 对象，那么后面的 then 方法会等待到他的结束</li>
</ul>
</li>
</ul>
<h4 id="异常处理"><a class="markdownIt-Anchor" href="#异常处理"></a> 异常处理</h4>
<p>两个回调<code>(onFulfilled，onRejected)</code> （只能在当前 then 方法调用中接住）</p>
<p>.catch （相当于两个回调 其中<code>(undefined，onRejected)</code> ，异常可以被传递，而被 catch 接住</p>
<p>unHandledRejection（全局）</p>
<h4 id="静态方法"><a class="markdownIt-Anchor" href="#静态方法"></a> 静态方法</h4>
<p><code>Promise.reslove()</code> 将一个值快速转换为 Promise 对象</p>
<p>用此方法包装一个 Promise 对象得到的还是原本的 Promise 对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="string">&quot;111&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p === p2) <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>如果用此方法，包装如下带有 then 方法的对象 <strong>(thenable 可以被 then 的对象)</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(&#123;</span><br><span class="line">  <span class="attr">then</span>: <span class="function">(<span class="params">onFulfilled, onRejected</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">onFulfilled</span>(<span class="string">&quot;qqqq&quot;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(res) <span class="comment">//qqqq</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>Promise.reject()</code> 无论传什么参数，都会作为 Promise 失败的理由</p>
<h4 id="priomse-并行执行"><a class="markdownIt-Anchor" href="#priomse-并行执行"></a> Priomse 并行执行</h4>
<p>在页面请求多个接口的情况，这些请求没有过多依赖，那么就可同时请求</p>
<p>怎么知道这些请求完成？传统用<u>计数器</u></p>
<p><code>Promise.all()</code> 多个 Promise 集中管理 （同步执行多个 Promise 的方式）等待所有 Promise 结束后</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>([xxx, yyy]) <span class="comment">// xxx,yyy为Promise对象</span></span><br></pre></td></tr></table></figure>
<p><code>Promise.race()</code> 只会等待第一个完成的任务，就结束</p>
<h4 id="promise-执行时序-宏任务-vs-微任务"><a class="markdownIt-Anchor" href="#promise-执行时序-宏任务-vs-微任务"></a> Promise 执行时序 宏任务 vs 微任务</h4>
<p>Promise 执行时序有点特殊</p>
<p>回调队列 Queue 中的任务 <font color=red><strong>『宏任务』</strong>，宏任务执行过程期间可能会加上额外的需求</font>，</p>
<p>​ 这些需求可以<u>选择</u>作为<u><em>新的宏任务</em></u>进入到队列 Queue 中排队</p>
<p>​ 也可以作为当前任务的<font color=red><strong>『微任务』</strong>，直接在当前任务结束之后立即执行</font>，而不是进入队列排队</p>
<p><strong>Promise 回调作为<em>微任务</em> 执行的</strong> （本轮结束的末尾，自动执行，不进入队列）</p>
<p>​ 如果处于 pending 状态就不能进入这一次微任务</p>
<p>​ await 后面的语句加入到微任务队列</p>
<p>微任务：提高整体的响应能力</p>
<blockquote>
<p>目前绝大多数异步调用都是作为宏任务执行</p>
<p>微任务：Promise、mutationObserver 以及 Node 中的 process.nextTick</p>
</blockquote>
<h3 id="generator-异步方案"><a class="markdownIt-Anchor" href="#generator-异步方案"></a> Generator 异步方案</h3>
<blockquote>
<p>Promise 处理异步任务的串联执行，仍然有大量的回调函数，虽然没有嵌套，影响阅读</p>
<img src="https://s2.loli.net/2024/03/25/L257BeUSh9HpoNy.png" alt="image-20230329205937527" style="zoom:35%; float:left;margin-left:30px"  />
<p>传统异步模式，更简洁，更利于阅读</p>
<img src="https://s2.loli.net/2024/03/25/X56H7Zl3Ns2MOwE.png" alt="image-20230329210419648" style="zoom:30%;float:left" />
</blockquote>
<h4 id="generator-es2015"><a class="markdownIt-Anchor" href="#generator-es2015"></a> Generator ES2015</h4>
<p>Generator 函数返回的遍历器对象都有一个 throw 方法，可以在函数体外抛出错误，然后在 Generator 函数体内捕获。外面 try catch 捕获</p>
<p>生成器函数执行器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> api = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;/api.json&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(api)</span><br><span class="line">    <span class="keyword">const</span> api2 = <span class="keyword">yield</span> <span class="title function_">ajax</span>(<span class="string">&quot;/api2.json&quot;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(api2)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* const g = main()</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    handleResult(g.next())</span></span><br><span class="line"><span class="comment">    // 生成器函数执行器</span></span><br><span class="line"><span class="comment">    function handleResult(result) &#123;</span></span><br><span class="line"><span class="comment">        if (result.done) return</span></span><br><span class="line"><span class="comment">        result.value.then(data =&gt; &#123;</span></span><br><span class="line"><span class="comment">            handleResult(g.next(data))</span></span><br><span class="line"><span class="comment">        &#125;,</span></span><br><span class="line"><span class="comment">            error =&gt; &#123;</span></span><br><span class="line"><span class="comment">                g.throw(error)</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        )</span></span><br><span class="line"><span class="comment">    &#125; */</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">co</span>(main)</span><br><span class="line"><span class="comment">// 生成器函数执行器</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">co</span>(<span class="params">generator</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> g = <span class="title function_">generator</span>()</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleResult</span>(g.<span class="title function_">next</span>())</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleResult</span>(<span class="params">result</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (result.<span class="property">done</span>) <span class="keyword">return</span></span><br><span class="line">    result.<span class="property">value</span>.<span class="title function_">then</span>(</span><br><span class="line">      <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">handleResult</span>(g.<span class="title function_">next</span>(data))</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">        g.<span class="keyword">throw</span>(error)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><u>异步调用扁平化</u></p>
<h3 id="async-await"><a class="markdownIt-Anchor" href="#async-await"></a> Async Await</h3>
<p>ES2017</p>
<p>不在需要类似 co 的执行器，语言层面的标准一步语法</p>
<p>async 函数返回的是一个 Promise 对象，利于控制整体</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>) <span class="comment">//1</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//宏任务1</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;children2&quot;</span>)</span><br><span class="line">  <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;children3&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;children4&quot;</span>) <span class="comment">//2</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//宏任务</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;children5&quot;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&quot;children6&quot;</span>)</span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 微任务</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;children7&quot;</span>)</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// start children4 children2 children3  children5  children7 children6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//juejin.cn/post/6950786264941461541</span></span><br></pre></td></tr></table></figure>
<h4 id="asyncawait-执行顺序"><a class="markdownIt-Anchor" href="#asyncawait-执行顺序"></a> async/await 执行顺序</h4>
<p>我们知道<code>async</code>隐式返回 Promise 作为结果的函数,那么可以简单理解为，await 后面的函数执行完毕时，await 会产生一个微任务(Promise.then 是微任务)。</p>
<p>但是我们要注意这个微任务产生的时机，它是执行完 await 之后，直接跳出 async 函数，执行其他代码(此处就是<strong>协程</strong>的运作，A 暂停执行，控制权交给 B)。</p>
<p><font color=red>其他代码执行完毕后，再回到 async 函数去执行剩下的代码，然后把 await 后面的代码注册到微任务队列当中</font>。我们来看个例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;script start&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">async2</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;async1 end&quot;</span>) <span class="comment">//1微任务</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;async2 end&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">async1</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;setTimeout&quot;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Promise&quot;</span>)</span><br><span class="line">  <span class="title function_">resolve</span>()</span><br><span class="line">&#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise1&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;promise2&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;script end&quot;</span>)</span><br><span class="line"><span class="comment">// 旧版输出如下，但是请继续看完本文下面的注意那里，新版有改动</span></span><br><span class="line"><span class="comment">// script start =&gt; async2 end =&gt; Promise =&gt; script end =&gt; promise1 =&gt; promise2 =&gt; async1 end =&gt; setTime</span></span><br></pre></td></tr></table></figure>

</div>
<div class="toc-menu-container">
    <img class="icon toc-menu" alt="">
</div>

<script>
    // const toc = document.querySelector('.toc')
    // const tocmenu = document.querySelector('.toc-menu-container')
    // tocmenu.addEventListener('click', ()=>{
    //     toc.style.display === 'block' ? toc.style.display = 'none' : toc.style.display = 'block'
    // })
    const tocRight = getComputedStyle(document.documentElement).getPropertyValue('--toc-right');
    window.addEventListener('DOMContentLoaded', (event) => {
        const toc = document.querySelector('.toc')

    
        const tocmenu = document.querySelector('.toc-menu-container')

        // 如果没有相关h标签，隐藏目录
        if (!document.querySelector('h1, h2, h3, h4, h5, h6')) {
            toc.style.display = 'none'
            tocmenu.style.display = 'none'
        }

        // 解决直接写入css文件的媒体查询，而是用js控制集中内容导致样式失效的方法
        const mediaQuery = window.matchMedia('(max-width: 1200px)')

        function handleTableOfContentsDisplay(e) {
            if (e.matches) { // If media query matches
                // toc.style.display = 'none'
                toc.style.right = '-100%'
                toc.style.transition = 'right .5s ease-in-out'
            } else {
                // toc.style.right = '20px'
                toc.style.right = tocRight
            }
        }
        //运行时调用
        handleTableOfContentsDisplay(mediaQuery)
        // 绑定媒体查询事件监听
        mediaQuery.addListener(handleTableOfContentsDisplay)


        const img = document.querySelector('.toc-menu')
        let timer
        tocmenu.addEventListener('click', () => {
            tocmenu.classList.add('scale-up-center')
            toc.style.right.includes('%') ? toc.style.right = tocRight : toc.style.right = '-100%'
            // 异步移除
            // if(timer) clearTimeout(timer)
            timer = setTimeout(() => {
                tocmenu.classList.remove('scale-up-center')
            }, 500)
            // img.classList.toggle('active')
            // if(img.classList.contains('active')){
            //     img.style.maskImage = "url('../../../source/css/icon/arrow-right.svg')"
            // }
        })
    })
</script>


<!-- 引入tocbot -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        tocbot.init({
            tocSelector: '.toc',
            contentSelector: '.post-body',
            listClass: 'toc-list', //toc ol列表class名
            linkClass: 'toc-link', //li 中a标签的class名
            headingSelector: 'h1 ,h2, h3, h4, h5',
            collapseDepth: '6',
            // isCollapsedClass: 'is-collapsed',
        });
    });
</script>
</div>

<script>
    // View a list of images.
    // Note: All images within the container will be found by calling `element.querySelectorAll('img')`.
    const gallery = new Viewer(document.querySelector('.post-body'), {
        slideOnTouch: true,
        toolbar: {
            zoomIn: 1,
            zoomOut: 1,
            oneToOne: 0,
            reset: 1,
            prev: {
                show: 1,
                size: 'large'
            },
            play: {
                show: 0,
                // size: 'large',
            },
            next: {
                show: 1,
                size: 'large'
            },
            rotateLeft: 0,
            rotateRight: 0,
            flipHorizontal: 0,
            flipVertical: 0,
        },
    })
    // Then, show one image by click it, or call `gallery.show()`.
</script>

<!-- <script>
    const mdImg = document.querySelectorAll('.post-content p img')
    const imgPreviewMask = document.querySelector('.image-preview-mask')
    const imgPreview = document.querySelector('#img-preview')
    window.addEventListener('DOMContentLoaded', ()=>{
        console.log(mdImg, imgPreview)
    })
    mdImg.forEach(item => {
        item.addEventListener('click', () => {
            imgPreviewMask.style.display = 'block'
            imgPreview.classList.add('image-preview');
            imgPreview.style.backgroundImage = `url(${item.src})`;

        })
    })

    imgPreviewMask.addEventListener('click', ()=>{
        imgPreview.classList.remove('image-preview')
        imgPreviewMask.style.display = 'none'
    })

</script> -->

<script>
    window.onload = detectors();
</script>
    <div class="post-footer">
    <div class="h-line-primary"></div>
    <nav class="post-nav">
        <div class="prev-item">
           
                <div class="icon arrow-left"></div>
                <div class="post-link">
                    <a href="/posts/RENEW-vue2/">Prev</a>
                </div>
            
        </div>
        <div class="next-item">
            
                <div class="icon arrow-right"></div>
                <div class="post-link">
                  <a href="/posts/FUNNY-ERROR/">Next</a>  
                </div>  
            
        </div>
    </nav>
</div>

    
      <div class="post-comment">
    
        
            <div id="vcomments"></div>
            <!-- <script>
                var META = ['nick', 'mail', 'link'];
                var meta = 'nick,mail';
                meta = meta.split(',').filter(item => {
                    return META.includes(item);
                });
                new Valine({
                    el: '#vcomments',
                    appId: '',
                    appKey: '',
                    lang: 'en',
                    placeholder: 'Say something',
                    avatar: 'mp',
                    meta: meta
                })
            </script> -->
            

                
                    
                        <div id="disqus_thread"></div>
                        <div id='tip' style="display: none; color: gray; font-style: italic; font-size: 0.9em;">" Please use a proxy to
                            use the comment function in 🇨🇳"</div>
                        <script>
                            /**
                            *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                            *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */

                            /* var disqus_config = function () {
                                this.page.url = 'http://example.com/posts/SUMMARY/';  // Replace PAGE_URL with your page's canonical URL variable
                                this.page.identifier = 'posts/SUMMARY/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                                this.language = 'en'
                            }; */

                            /* (function () { // DON'T EDIT BELOW THIS LINE
                                var d = document, s = d.createElement('script');
                                s.src = 'https://http-ye1223-github-io.disqus.com/embed.js';
                                s.setAttribute('data-timestamp', +new Date());
                                (d.head || d.body).appendChild(s);
                            })(); */




                            function loadDisqus() {
                                // 检测是否存在评论
                                if (!document.querySelector('#disqus_thread iframe')) {
                                    document.getElementById('tip').style.display = 'block'
                                } else {
                                    document.getElementById('tip').style.display = 'none'
                                }
                                // Disqus 安装代码
                                var d = document, s = d.createElement('script');
                                s.src = 'https://http-ye1223-github-io.disqus.com/embed.js';
                                s.setAttribute('data-timestamp', +new Date());
                                (d.head || d.body).appendChild(s);
                                window.disqus_config = function () {
                                    this.page.url = 'http://example.com/posts/SUMMARY/';
                                    this.page.identifier = 'posts/SUMMARY/';
                                    this.language = 'en'
                                };
                                // 如果你和我一样在用 DisqusJS，loadDisqus() 里就应该是 DisqusJS 的初始化代码 new DisqusJS({...})
                            }

                            // 通过检查 window 对象确认是否在浏览器中运行
                            var runningOnBrowser = typeof window !== "undefined";
                            // 通过检查 scroll 事件 API 和 User-Agent 来匹配爬虫
                            var isBot = runningOnBrowser && !("onscroll" in window) || typeof navigator !== "undefined" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);
                            // 检查当前浏览器是否支持 IntersectionObserver API
                            var supportsIntersectionObserver = runningOnBrowser && "IntersectionObserver" in window;

                            // 检测
                            /* const iframeObserver = new IntersectionObserver((entries)=>{
                                if(entries[0].isIntersecting){
                                    iframeObserver.disconnect()
                                }
                            })
                            iframeObserver.observe(document.querySelector('#disqus_thread iframe')) */

                            // 一个小 hack，将耗时任务包裹在 setTimeout(() => { }, 1) 中，可以推迟到 Event Loop 的任务队列中、等待主调用栈清空后才执行，在绝大部分浏览器中都有效
                            // 其实这个 hack 本来是用于优化骨架屏显示的。一些浏览器总是等 JavaScript 执行完了才开始页面渲染，导致骨架屏起不到降低 FCP 的优化效果，所以通过 hack 将耗时函数放到骨架屏渲染完成后再进行。
                            setTimeout(function () {
                                if (!isBot && supportsIntersectionObserver) {
                                    // 当前环境不是爬虫、并且浏览器兼容 IntersectionObserver API
                                    var disqus_observer = new IntersectionObserver(function (entries) {
                                        // 当前视窗中已出现 Disqus 评论框所在位置
                                        if (entries[0].isIntersecting) {
                                            // 加载 Disqus
                                            loadDisqus();
                                            // 停止当前的 Observer
                                            disqus_observer.disconnect();
                                        }
                                    }, { threshold: [0] });
                                    // 设置让 Observer 观察 #disqus_thread 元素
                                    disqus_observer.observe(document.getElementById('disqus_thread'));
                                } else {
                                    // 当前环境是爬虫、或当前浏览器其不兼容 IntersectionObserver API
                                    // 直接加载 Disqus
                                    loadDisqus();
                                }
                            }, 1)
                        </script>
                        <noscript>Please enable JavaScript to view the <a
                                target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                        



</div>
     
  
</article>
        </div>
      </div>
      <div class="footer">
    <div class="flex-container">
        <div class="footer-text">
            
            
            
               ©️<a target="_blank" rel="noopener" href="https://github.com/ye1223 ">Levy Liu</a> | Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/zoeingwingkei/frame/">Frame.</a>
                
        </div>
    </div>
</div>


        <!-- 提示词 -->

        <div class="tip-toast">
          <!-- <img class="close" src=`${location.origin}icon/close-btn.svg` alt=""> -->
          <img class="close" src="https://ye1223.github.io/icon/close-btn.svg" alt="">
          <p>You'd better use a PROXY to enhance your browsing experience</p>
        </div>

        <!-- 创建toast提示框 -->
        <script>
          window.addEventListener('DOMContentLoaded', () => {
            // const tipToast = document.createElement('div')
            // tipToast.innerHTML = `<p>You'd better use a PROXY to enhance your browser experience</p>`
            // tipToast.classList.add('tip-toast')
            // document.body.appendChild(tipToast)

            const tipToast = document.querySelector('.tip-toast')
            const closeIcon = document.querySelector('.tip-toast .close')
            let timer = null

            // sessionStorage是否有tipToast（用于跨页面判断）
            // if(sessionStorage.getItem('tipToast')){
            //   // 有的话--设为false
            //   sessionStorage.setItem('tipToast', false)
            // } else {
            //   sessionStorage.setItem('tipToast', true)
            // }
            sessionStorage.getItem('tipToast') ? sessionStorage.setItem('tipToast', false) : sessionStorage.setItem('tipToast', true)

            if (sessionStorage.getItem('tipToast') === 'false') {
              tipToast.style.display = 'none'
              return

            } else {
              // 开始呼出tip
              tipToast.style.right = '10px'
              tipToast.style.transition = 'right .5s ease-in-out'

              // 时间到了隐藏tip
              timer = setTimeout(() => {
                tipToast.style.right = '-100%'
                tipToast.style.transition = 'right .5s ease-in-out'
                sessionStorage.setItem('tipToast', false)
              }, 30000)
            }

            closeIcon.addEventListener('click', () => {
              tipToast.style.right = '-100%'
              tipToast.style.transition = 'right .5s ease-in-out'
              timer = null
              sessionStorage.setItem('tipToast', false)
            })


          })
        </script>

        <!-- mermaid语法支持 -->
        
          <!-- <script src='https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js'></script> -->
          <!-- <script src='https://cdn.jsdelivr.net/npm/mermaid@7.1.2/dist/mermaid.min.js'></script> -->
          <script src='https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.1.2/mermaid.min.js'></script>
          <script>
            if (window.mermaid) {
              mermaid.initialize({ theme: 'forest' });
            }
          </script>
          
            <!-- highlight.js csr渲染 -->
            <!-- <script src="https://cdn.jsdelivr.net/npm/highlightjs"></script>
            <script src="https://cdn.jsdelivr.net/npm/highlightjs-vue"></script>
            <script>
              hljs.registerLanguage("vue", window.hljsDefineVue);
              hljs.initHighlightingOnLoad();
            </script> -->

  </div>

  
    <div class="search-popup">
    <div class="search-popup-overlay">  
    </div>
    <div class="search-popup-window" >
        <div class="search-header">
            <div class="search-input-container">
              <input autocomplete="off" autocapitalize="off" maxlength="80"
                     placeholder="Search Anything" spellcheck="false"
                     type="search" class="search-input">
            </div>
            <div class="search-close-btn">
                <div class="icon close-btn"></div>
            </div>
        </div>
        <div class="search-result-container">
        </div>
    </div>
</div>

<script>
    const searchConfig = {
        path             : "/search.xml",
        top_n_per_article: "1",
        unescape         : "false",
        trigger: "auto",
        preload: "false"
    }
</script>
<!-- <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.0/search.min.js"></script>
<script src="/js/search.js"></script>
      

</body>

</html>